
# 每月200美元以下构建基础设施

技术文章 来源：https://sdk.cn/news/6111   

摘要：在上线新服务之前，你首先需要构建起基础设施。你的基础设施要具有稳定性、可扩展性等特点。而且你还不能把所有钱都花在基础设施上。在过去的几年中，我积累了很多经验和资源，这篇文章的目的就是帮你找到那些便宜好用的基础设施服务，在为用户提供价值的同时，帮你降低基础设施方面的开销。 文章中推荐的所有服务和工具，都和我没有任何直接的经济关系，我推荐他们纯粹是因为他们好用，而且便宜。

在上线新服务之前，你首先需要构建起基础设施。你的基础设施要具有稳定性、可扩展性等特点。而且你还不能把所有钱都花在基础设施上。

在过去的几年中，我积累了很多经验和资源，这篇文章的目的就是帮你找到那些便宜好用的基础设施服务，在为用户提供价值的同时，帮你降低基础设施方面的开销。

文章中推荐的所有服务和工具，都和我没有任何直接的经济关系，我推荐他们纯粹是因为他们好用，而且便宜。

**你需要：**

-   一个稳定性高的API
-   一个Web应用（除非你的产品只有一个单纯的API）
-   文件存储
-   两个环境：一个用于测试和演示，一个用于实际生产
-   监测生产平台的工具
-   对生产服务器进行动态扩张的能力

**实际生产 VS 事前准备**

你将会需要两个环境：一个生产环境，也就是你的客户使用的那个环境；还有一个就是准备环境，你要在这里进行测试，或是向客户演示demo功能。

准备环境不需要你进行过多的调试。

而生产环境则需要你做好各方面的平衡，为了获得较高的稳定性，你要为所有东西对准备至少两个instance。稍后我们将介绍一些能帮你进行24/7监测的工具。

**后端Hosting**

我推荐你将后端API寄存在Heroku上，因为它支持的语言种类最多。请注意，Heroku官方还没有支持ASP.NET，但是你可以找到一些开源build pack来解决这个问题。

**我推荐的服务套餐为：**

-   1 准备环境使用hobby dyno，价格为7美元一个月
-   2 生产环境使用standard-1X dynos，价格为25美元一个月

花费：57美元/月

**数据库Hosting**

如果你使用的是PostgreSQL，那么你依然可以使用Heroku的数据库hosting服务。如果你使用的是其他类型的数据库，你可以选择Compose，它价格最低的套餐，可以满足初创企业的需求。当你的需求提高的时候，你可以选择变更套餐。

Compose的服务包含了那些重要的东西：节点故障恢复、每日备份、SSL加密和基本的监测面板。

你可以将准备数据库和生产数据库都放在Compose中。需要注意的是，你一定要避免将那些未经测试的代码放到生产数据库中。

价格方面，由于我们使用的是MongoDB数据库，因此其价格是31美元/月，PostgreSQL数据库的价格为27美元/月。

花费：62美元/月

**前端Hosting**

我推荐使用Netlify，因为它使用起来非常简单：

-   连接你的BitBucket/GitHub/GitLab账户
-   选择repo和分支进行部署
-   设置build命令并生成文件夹-   将正确的Git分支完成推送之后，Netlify的服务器上将会出现一个build，然后自动将其部署到他们的CDN上。详细说明可以参考[这里](https://www.netlify.com/docs/continuous-deployment/)。

你可以为准备平台选择免费套餐，为生产平台选择9美元/月的套餐。

花费：9美元/月

**文件Hosting**

文件寄存方面，我推荐AWS S3。你需要创建两个bucket—一个用作准备环境，一个用作生产环境。

内容分发使用的是AWS CDN，数据可以安全的存储和调用。

价格方面，AWS提供了5GB的免费空间，之后每GB 0.03美元。因此如果你的数据不多，你无需任何花费。

花费：0美元/月

**域名与SSL**

你还要买一个域名，大多数域名每年只需要不到50美元的价格。

你之后可以使用[Let’s Encrypt](https://letsencrypt.org/)为所有endpoint生成证书。它提供了支持CA的SSL证书的免费生成服务，大多数浏览器都支持这种证书。

花费: 50美元/年

**监测工具**

对生产平台的监测是你日常工作的关键，当问题发生的时候，你需要第一时间知晓并且对其进行修复。在遇到小问题的时候，用户不会主动向你报告，但是这些小问题却会影响他们对你的印象。

**Slack**

Slack能将所有错误报告放在一起显示。它是针对团队协作所设计的一个服务，但是你完全也有可以独自使用。

你要创建一个Slack账户，然后创建一个名为#prod-errors的channel。你还需要对其他服务进行配置，允许Slack调用它们的错误报告。

Once you install each services’ Slack app and enable its notifications for desktop and mobile, you’ll be good to go.在完成配置之后，打开Slack桌面端和移动端的通知，它就可以用了。它简直就是初创企业的24/7 on-call监测团队。

**日志记录**

在日志管理方面，我推荐[Papertrail](https://papertrailapp.com/)，它提供了：

一个基于日志控制台的web应用

每日将你的日志备份到独立的储存位置中

你还可以对提醒频率进行配置，只在需要的时候对你推送警报

这是它的界面：

格方面，在准备平台上，你可以使用它的免费服务。而在生产平台上，你可以选择它的Fixa套餐，费用为7美元/月。

费用：7美元/月

**Sentry**

你的API、web应用和移动应用，应该将错误和期望发送给Sentry。然后你要让Sentry将错误推送给你的Slack #prod-errors channel。

Sentry的免费套餐就很好，它每天最多支持5000个事件。最低付费套餐的价格为29美元/月。

费用：29美元/月

**Uptimerobot**

这是一个健康程度检查工具，可以查看你的服务是否正在正常运行。

目前这个工具只有免费版本。

费用：0美元/月

**Librato**

虽然Heroku提供了API的最近指标查看功能，但是它只能查看过往3天以内的指标。在这方面，[Librato](https://www.librato.com/)提供的服务要更好。

你可以为你的准备平台使用免费套餐。为生产平台使用Nickel套餐，价格为19美元/月，这个套餐可以让你查看过往四周内的API指标。

费用：19美元/月

**总费用统计：**

-   Heroku：57美元/月
-   Compose：62美元每月
-   Netlify：9美元/月
-   域名：约4美元/月
-   Papertrail/Sentry/Librato：55美元/月

**合计：187美元/月**

.就这样，我们只用了不到200美元/月的价格，就构建起了足够初创企业使用的基础设施。

**总结**

如果你正在考虑发布一个SaaS服务，我希望这篇文章能让你意识到，只要用对了工具，构建基础设施其实并没有那么复杂，费用也不会太高昂。

毕竟，你的工作重心应该是为用户提供价值，而不是基础设施的搭建。

源自： https://medium.freecodecamp.org/how-your-startup-can-leverage-production-grade-infrastructure-for-less-than-200-month-15c3724038b4
<!--stackedit_data:
eyJoaXN0b3J5IjpbNTI1NjA5ODQyXX0=
-->